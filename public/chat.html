<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0" />
  <title>注册</title>
  <link href="css/common.css" rel="stylesheet" />
  <link href="css/chat.css" rel="stylesheet" />
  <!-- <script src="https://res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/vconsole/2.5.1/vconsole.min.js"></script> -->
</head>

<body>
  <div class="bg">
    <div class="bg-layer chat-layer">
      <header class="header chat-tit">
        <span>
          <</span>
            聊天室标题
      </header>
      <section class="chat-room" id="chat-room">
        <div class="chat-bubble">
          <div class="chat-head"></div>
          <div class="chat-cont">
            <div class="chat-name">盖伦</div>
            <div class="chat-msg">
              人在塔在，人在塔不在
            </div>
          </div>
        </div>
        <div class="chat-bubble">
          <div class="chat-head"></div>
          <div class="chat-cont">
            <div class="chat-name">嘉文四世</div>
            <div class="chat-msg">
              犯我德邦者，虽远必诛
            </div>
          </div>
        </div>
        <div class="chat-bubble">
          <div class="chat-head"></div>
          <div class="chat-cont">
            <div class="chat-name">戴安娜</div>
            <div class="chat-msg">
              月亮将会升起，夜晚将会永存
            </div>
          </div>
        </div>
        <div class="chat-bubble">
          <div class="chat-head"></div>
          <div class="chat-cont">
            <div class="chat-name">戴安娜</div>
            <div class="chat-msg">
              以前他们叫我异教徒，现在他们都死了
            </div>
          </div>
        </div>
        <div class="chat-bubble myself">
          <div class="chat-head"></div>
          <div class="chat-cont">
            <div class="chat-name">木木</div>
            <div class="chat-msg">
              我还以为，你从来都不会选我呢
            </div>
          </div>
        </div>
        <div class="chat-bubble">
          <div class="chat-head"></div>
          <div class="chat-cont">
            <div class="chat-name">亚索</div>
            <div class="chat-msg">
              面对疾风吧，面对疾风吧，面对疾风吧，面对疾风吧，面对疾风吧，面对疾风吧，面对疾风吧，面对疾风吧，面对疾风ffffffffff吧，
            </div>
          </div>
        </div>
      </section>
      <footer>
        <div class="chat-input">
          <input id="msg-input" type="text" />
        </div>
        <div class="send-btn">
          <span class="send-item">图</span>
          <span class="send-item">视</span>
          <span class="send-item">音</span>
          <span class="send-item">址</span>
        </div>
      </footer>
    </div>
  </div>
  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/socket.io.js"></script>
  <script>
    var socket = io();
    // 加入房间
    socket.on('sys', function (data) {
      var msgDom = $('<div class="join">--' + data.msg + '--</div>');
      $('#chat-room').append(msgDom).scrollTop($("#chat-room")[0].scrollHeight);
    });

    socket.on('get msg', function (data) {
      var msg = '<div class="chat-bubble">\n          <div class="chat-head"></div>\n          <div class="chat-cont">\n            <div class="chat-name">\u6728\u6728</div>\n            <div class="chat-msg">\n              ' + data.msg + '\n            </div>\n          </div>\n        </div>';

      $('#chat-room').append($(msg)).scrollTop($("#chat-room")[0].scrollHeight);
    });

    $('#msg-input').keydown(function (e) {
      if (e.keyCode === 13) {
        var msg = '<div class="chat-bubble myself">\n          <div class="chat-head"></div>\n          <div class="chat-cont">\n            <div class="chat-name">\u6728\u6728</div>\n            <div class="chat-msg">\n              ' + $(this).val() + '\n            </div>\n          </div>\n        </div>';

        $('#chat-room').append($(msg)).scrollTop($("#chat-room")[0].scrollHeight);
        socket.emit('send msg', { params: $(this).val() });
        $(this).val('');
        return false;
      }
    });
  </script>
</body>

</html>